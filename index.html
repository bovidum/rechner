<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Feierabend- & Zeitkonto Rechner</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --orange:#ff9800;
    --orange-dark:#f57c00;
    --bg:#f2f2f2;
    --card:#fff;
    --text:#333;
    --okbg:#e8f5e9;
    --oktxt:#1b5e20;
    --warnbg:#fff8e1;
    --warntxt:#6d4c00;
  }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
  body{margin:0;padding:14px;background:var(--bg);color:var(--text)}
  .wrap{max-width:560px;margin:0 auto}
  .title{
    background:var(--orange-dark);color:#fff;padding:14px 16px;border-radius:14px;
    font-weight:800;text-align:center;box-shadow:0 4px 10px rgba(0,0,0,.15)
  }
  .block{
    margin-top:16px;background:var(--card);border-radius:14px;overflow:hidden;
    box-shadow:0 8px 18px rgba(0,0,0,.12);border:1px solid #e0e0e0
  }
  .blockhead{
    background:var(--orange);color:#fff;padding:10px 12px;font-weight:800;text-align:center
  }
  .card{padding:14px}
  .hint{font-size:.82rem;color:#666;line-height:1.35;margin:6px 0 12px}
  .row{margin-bottom:10px}
  label{display:block;font-weight:800;margin-bottom:4px}
  small{display:block;font-size:.75rem;color:#666;margin-top:4px}
  input[type="time"]{
    padding:7px 9px;font-size:.98rem;border-radius:10px;border:1px solid #bdbdbd;width:170px
  }
  .btnrow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  button{
    border-radius:999px;border:none;padding:9px 14px;font-size:.92rem;cursor:pointer;font-weight:800;
    background:var(--orange);color:#fff;box-shadow:0 3px 6px rgba(0,0,0,.2)
  }
  button.secondary{background:#fff;color:#555;border:1px solid #ccc;box-shadow:none}
  .error{color:#c62828;font-size:.85rem;margin-top:6px}
  .results{margin-top:12px;padding-top:12px;border-top:1px dashed #ccc;display:none}
  .rrow{display:flex;justify-content:space-between;gap:10px;margin-bottom:9px;align-items:baseline}
  .rlabel{font-weight:800;font-size:.92rem}
  .rval{font-weight:900;text-decoration:underline;text-decoration-thickness:2px;white-space:nowrap}
  .rval.orange{color:var(--orange-dark)}
  .note{
    margin-top:10px;border-radius:12px;padding:10px 12px;font-size:.88rem;line-height:1.35;display:none
  }
  .note.ok{background:var(--okbg);color:var(--oktxt);border:1px solid #c8e6c9}
  .note.warn{background:var(--warnbg);color:var(--warntxt);border:1px solid #ffe082}
  .foot{margin:18px 0 8px;text-align:center;color:#888;font-size:.78rem}
</style>
</head>
<body>
<div class="wrap">
  <div class="title">Zeitkonto und Feierabend Rechner von Max</div>

  <!-- ===================== Gemeinsame Regeln ===================== -->
  <div class="block">
    <div class="blockhead">Regeln (f√ºr alle Rechner)</div>
    <div class="card">
      <div class="hint">
        <b>Fix:</b> Dienstzeit (Arbeitszeit) <b>7:48 h</b> ¬∑ Duschzeit <b>0:25 h</b> ¬∑ Pause wird <b>automatisch</b> berechnet.<br>
        <b>Dienstende</b> = Arbeitszeit + Pause (on top).<br>
        <b>Tageszettel</b> = Arbeitszeit <b>ohne Pause</b> (Duschzeit z√§hlt mit).<br>
        <b>Pause automatisch:</b> ‚â§ 9:00 h Arbeitszeit ‚Üí 0:30 ¬∑ &gt; 9:00 h Arbeitszeit ‚Üí 0:45
      </div>
    </div>
  </div>

  <!-- ===================== Rechner 1 ===================== -->
  <div class="block">
    <div class="blockhead">Rechner 1 ‚Äì Wunsch-Dienstende ‚Üí Entnahme Zeitkonto</div>
    <div class="card">
      <div class="row">
        <label for="r1_start">Dienstbeginn</label>
        <input id="r1_start" type="time">
        <small>z. B. 05:30</small>
      </div>
      <div class="row">
        <label for="r1_endwish">Dienstende Wunsch (mit Duschen)</label>
        <input id="r1_endwish" type="time">
        <small>Ende inkl. Duschzeit</small>
      </div>

      <div class="btnrow">
        <button type="button" onclick="calcR1()">üëâ Berechnen</button>
        <button class="secondary" type="button" onclick="resetR1()">‚ôª Zur√ºcksetzen</button>
      </div>

      <div id="r1_err" class="error"></div>

      <div class="results" id="r1_res">
        <div class="rrow"><div class="rlabel">Beginn Duschzeit</div><div class="rval" id="r1_shower"></div></div>
        <div class="rrow"><div class="rlabel">Zeit auf dem Tageszettel</div><div class="rval" id="r1_zettel"></div></div>
        <div class="rrow"><div class="rlabel">Entnahme ZEITKONTO</div><div class="rval orange" id="r1_entnahme"></div></div>
        <div class="rrow"><div class="rlabel">Regul√§res Dienstende (mit Duschen)</div><div class="rval" id="r1_regend"></div></div>
        <div class="rrow"><div class="rlabel">Pause (automatisch)</div><div class="rval" id="r1_pause"></div></div>
        <div id="r1_note" class="note"></div>
      </div>
    </div>
  </div>

  <!-- ===================== Rechner 2 ===================== -->
  <div class="block">
    <div class="blockhead">Rechner 2 ‚Äì Entnahme Zeitkonto ‚Üí Dienstende / Duschzeit / Tageszettel</div>
    <div class="card">
      <div class="row">
        <label for="r2_start">Dienstbeginn</label>
        <input id="r2_start" type="time">
      </div>
      <div class="row">
        <label for="r2_entnahme">Entnahme ZEITKONTO (h:mm)</label>
        <input id="r2_entnahme" type="time" step="60" value="">
        <small>z. B. 01:48</small>
      </div>

      <div class="btnrow">
        <button type="button" onclick="calcR2()">üëâ Berechnen</button>
        <button class="secondary" type="button" onclick="resetR2()">‚ôª Zur√ºcksetzen</button>
      </div>

      <div id="r2_err" class="error"></div>

      <div class="results" id="r2_res">
        <div class="rrow"><div class="rlabel">Zeit auf dem Tageszettel</div><div class="rval" id="r2_zettel"></div></div>
        <div class="rrow"><div class="rlabel">Beginn Duschzeit</div><div class="rval" id="r2_shower"></div></div>
        <div class="rrow"><div class="rlabel">Dienstende nach Entnahme (mit Duschen)</div><div class="rval orange" id="r2_end"></div></div>
        <div class="rrow"><div class="rlabel">Pause (automatisch)</div><div class="rval" id="r2_pause"></div></div>
        <div id="r2_note" class="note"></div>
      </div>
    </div>
  </div>

  <!-- ===================== Rechner 3 ===================== -->
  <div class="block">
    <div class="blockhead">Rechner 3 ‚Äì Feierabend Rechner (optional Schichtverl√§ngerung)</div>
    <div class="card">
      <div class="row">
        <label for="r3_start">Dienstbeginn</label>
        <input id="r3_start" type="time">
      </div>

      <div class="row">
        <label for="r3_ext">Schichtverl√§ngerung (Arbeitszeit extra, h:mm)</label>
        <input id="r3_ext" type="time" value="00:00">
        <small>z. B. 02:00 = +2h Arbeitszeit (Pause wird automatisch berechnet)</small>
      </div>

      <div class="btnrow">
        <button type="button" onclick="calcR3()">üëâ Berechnen</button>
        <button class="secondary" type="button" onclick="resetR3()">‚ôª Zur√ºcksetzen</button>
      </div>

      <div id="r3_err" class="error"></div>

      <div class="results" id="r3_res">
        <div class="rrow"><div class="rlabel">Reine Arbeitszeit (ohne Pause)</div><div class="rval" id="r3_work"></div></div>
        <div class="rrow"><div class="rlabel">Beginn Duschzeit</div><div class="rval" id="r3_shower"></div></div>
        <div class="rrow"><div class="rlabel">Dienstende mit Duschen</div><div class="rval orange" id="r3_end"></div></div>
        <div class="rrow"><div class="rlabel">Pause (automatisch)</div><div class="rval" id="r3_pause"></div></div>
        <div id="r3_note" class="note"></div>
      </div>
    </div>
  </div>

  <!-- ===================== Rechner 4 ===================== -->
  <div class="block">
    <div class="blockhead">Rechner 4 ‚Äì Spontaner Feierabend ‚Äûab jetzt‚Äú ‚Üí Tageszettel / Entnahme</div>
    <div class="card">
      <div class="row">
        <label for="r4_now">Zeitpunkt Anfrage (Jetzt)</label>
        <input id="r4_now" type="time">
        <small>Wenn Kollege ‚Äûab sofort‚Äú Feierabend will</small>
      </div>
      <div class="row">
        <label for="r4_start">Dienstbeginn</label>
        <input id="r4_start" type="time">
      </div>
      <div class="row">
        <label for="r4_pause">Pause genommen?</label>
        <input id="r4_pause" type="time" value="00:30">
        <small>Standard 00:30 ¬∑ wenn noch keine Pause: 00:00</small>
      </div>

      <div class="btnrow">
        <button type="button" onclick="calcR4()">üëâ Berechnen</button>
        <button class="secondary" type="button" onclick="resetR4()">‚ôª Zur√ºcksetzen</button>
      </div>

      <div id="r4_err" class="error"></div>

      <div class="results" id="r4_res">
        <div class="rrow"><div class="rlabel">Dienstende (ab jetzt + Duschen)</div><div class="rval orange" id="r4_end"></div></div>
        <div class="rrow"><div class="rlabel">Beginn Duschzeit</div><div class="rval" id="r4_shower"></div></div>
        <div class="rrow"><div class="rlabel">Zeit auf dem Tageszettel</div><div class="rval" id="r4_zettel"></div></div>
        <div class="rrow"><div class="rlabel">Entnahme ZEITKONTO</div><div class="rval" id="r4_entnahme"></div></div>
        <div class="rrow"><div class="rlabel">Regul√§res Dienstende (mit Duschen)</div><div class="rval" id="r4_regend"></div></div>
      </div>
    </div>
  </div>

  <!-- ===================== Rechner 5 ===================== -->
  <div class="block">
    <div class="blockhead">Rechner 5 ‚Äì Tageszettel aus Dienstbeginn + Beginn Duschzeit (ArbZG)</div>
    <div class="card">
      <div class="row">
        <label for="r5_start">Dienstbeginn</label>
        <input id="r5_start" type="time">
      </div>
      <div class="row">
        <label for="r5_paper">Beginn Duschzeit (Papiere abgeben)</label>
        <input id="r5_paper" type="time">
      </div>

      <div class="btnrow">
        <button type="button" onclick="calcR5()">üëâ Berechnen</button>
        <button class="secondary" type="button" onclick="resetR5()">‚ôª Zur√ºcksetzen</button>
      </div>

      <div id="r5_err" class="error"></div>

      <div class="results" id="r5_res">
        <div class="rrow"><div class="rlabel">Dienstende mit Duschen</div><div class="rval orange" id="r5_end"></div></div>
        <div class="rrow"><div class="rlabel">Beginn Duschzeit</div><div class="rval" id="r5_shower"></div></div>
        <div class="rrow"><div class="rlabel">Pause (automatisch)</div><div class="rval" id="r5_pause"></div></div>
        <div class="rrow"><div class="rlabel">Zeit auf dem Tageszettel</div><div class="rval" id="r5_zettel"></div></div>
        <div id="r5_note" class="note"></div>
      </div>
    </div>
  </div>

  <div class="foot">Entwickelt von Max VR13</div>
</div>

<script>
  // ======= Fixwerte =======
  const BASE_WORK = 7*60 + 48; // 7:48 reine Arbeitszeit
  const DUSCH = 25;            // 25 Minuten
  const LIMIT9 = 9*60;         // 9:00
  const P30 = 30;
  const P45 = 45;

  // ======= Helfer =======
  function parseHM(str){
    if(!str) return NaN;
    const p=str.split(":");
    if(p.length<2) return NaN;
    const h=parseInt(p[0],10), m=parseInt(p[1],10);
    if(Number.isNaN(h)||Number.isNaN(m)) return NaN;
    return h*60 + m;
  }
  function fmtClock(mins){
    mins = ((mins%(24*60)) + (24*60)) % (24*60);
    const h=Math.floor(mins/60), m=mins%60;
    return String(h).padStart(2,"0")+":"+String(m).padStart(2,"0")+" Uhr";
  }
  function fmtDur(mins){
    const sign = mins<0 ? "-" : "";
    mins = Math.abs(mins);
    const h=Math.floor(mins/60), m=mins%60;
    return sign + h + ":" + String(m).padStart(2,"0") + " h";
  }
  // Uhrzeit-Differenz (wenn negativ -> +24h)
  function diffClock(a,b){
    let d=a-b;
    if(d<0) d+=24*60;
    return d;
  }
  // Pause nach ArbZG anhand reiner Arbeitszeit (ohne Pause)
  function pauseForWork(workNoPause){
    return (workNoPause > LIMIT9) ? P45 : P30;
  }
  // Stabiler Auto-Pause-Resolver aus Anwesenheit:
  // wir starten mit 30, pr√ºfen ob (presence - 30) > 9h => 45
  function autoPauseFromPresence(presence){
    return ((presence - P30) > LIMIT9) ? P45 : P30;
  }

  // ======= Rechner 1 =======
  function calcR1(){
    const err=document.getElementById("r1_err");
    err.textContent="";
    const s=parseHM(document.getElementById("r1_start").value);
    const ew=parseHM(document.getElementById("r1_endwish").value);

    if(Number.isNaN(s)||Number.isNaN(ew)){
      err.textContent="Bitte Dienstbeginn und Dienstende Wunsch eingeben.";
      document.getElementById("r1_res").style.display="none";
      return;
    }

    const presence = diffClock(ew, s); // inkl. Pause & Duschen
    const pause = autoPauseFromPresence(presence);
    const workedNoPause = presence - pause; // Tageszettel

    // Entnahme = fehlende Arbeitszeit zur 7:48
    const entnahme = Math.max(0, BASE_WORK - workedNoPause);

    // Regul√§res Dienstende = Start + 7:48 + Pause (auto)
    const regEnd = s + BASE_WORK + pause;

    document.getElementById("r1_shower").textContent = fmtClock(ew - DUSCH);
    document.getElementById("r1_zettel").textContent  = fmtDur(workedNoPause);
    document.getElementById("r1_entnahme").textContent= fmtDur(entnahme);
    document.getElementById("r1_regend").textContent  = fmtClock(regEnd);
    document.getElementById("r1_pause").textContent   = fmtDur(pause);

    const note=document.getElementById("r1_note");
    note.style.display="block";
    note.className = "note " + (pause===P45 ? "warn" : "ok");
    note.textContent = (pause===P45)
      ? "‚ö†Ô∏è Arbeitszeit √ºber 9 Stunden ‚Üí 45 Minuten Pause erforderlich."
      : "‚úÖ Bis 9 Stunden Arbeitszeit ‚Üí 30 Minuten Pause ausreichend.";

    document.getElementById("r1_res").style.display="block";
  }
  function resetR1(){
    document.getElementById("r1_start").value="";
    document.getElementById("r1_endwish").value="";
    document.getElementById("r1_err").textContent="";
    document.getElementById("r1_res").style.display="none";
  }

  // ======= Rechner 2 =======
  function calcR2(){
    const err=document.getElementById("r2_err");
    err.textContent="";
    const s=parseHM(document.getElementById("r2_start").value);
    let ent=parseHM(document.getElementById("r2_entnahme").value);

    if(Number.isNaN(s)||Number.isNaN(ent)){
      err.textContent="Bitte Dienstbeginn und Entnahme (h:mm) eingeben.";
      document.getElementById("r2_res").style.display="none";
      return;
    }
    // Ziel-Arbeitszeit (ohne Pause) = 7:48 - Entnahme
    const work = Math.max(0, BASE_WORK - ent);
    const pause = pauseForWork(work);
    const end = s + work + pause;      // Dienstende mit Duschen
    const shower = end - DUSCH;

    document.getElementById("r2_zettel").textContent = fmtDur(work);
    document.getElementById("r2_shower").textContent = fmtClock(shower);
    document.getElementById("r2_end").textContent = fmtClock(end);
    document.getElementById("r2_pause").textContent = fmtDur(pause);

    const note=document.getElementById("r2_note");
    note.style.display="block";
    note.className="note "+(pause===P45?"warn":"ok");
    note.textContent = (pause===P45)
      ? "‚ö†Ô∏è Arbeitszeit √ºber 9 Stunden ‚Üí 45 Minuten Pause."
      : "‚úÖ Bis 9 Stunden ‚Üí 30 Minuten Pause.";

    document.getElementById("r2_res").style.display="block";
  }
  function resetR2(){
    document.getElementById("r2_start").value="";
    document.getElementById("r2_entnahme").value="";
    document.getElementById("r2_err").textContent="";
    document.getElementById("r2_res").style.display="none";
  }

  // ======= Rechner 3 =======
  function calcR3(){
    const err=document.getElementById("r3_err");
    err.textContent="";
    const s=parseHM(document.getElementById("r3_start").value);
    let ext=parseHM(document.getElementById("r3_ext").value);
    if(Number.isNaN(s)||Number.isNaN(ext)){
      err.textContent="Bitte Dienstbeginn eingeben (Schichtverl√§ngerung optional).";
      document.getElementById("r3_res").style.display="none";
      return;
    }
    // Reine Arbeitszeit (ohne Pause) = 7:48 + Verl√§ngerung (Arbeitszeit)
    const work = BASE_WORK + Math.max(0, ext);
    const pause = pauseForWork(work);
    const end = s + work + pause;
    const shower = end - DUSCH;

    document.getElementById("r3_work").textContent = fmtDur(work);
    document.getElementById("r3_shower").textContent = fmtClock(shower);
    document.getElementById("r3_end").textContent = fmtClock(end);
    document.getElementById("r3_pause").textContent = fmtDur(pause);

    const note=document.getElementById("r3_note");
    note.style.display="block";
    note.className="note "+(pause===P45?"warn":"ok");
    note.textContent = (pause===P45)
      ? "‚ö†Ô∏è Arbeitszeit √ºber 9 Stunden ‚Üí 45 Minuten Pause erforderlich."
      : "‚úÖ Bis 9 Stunden Arbeitszeit ‚Üí 30 Minuten Pause ausreichend.";

    document.getElementById("r3_res").style.display="block";
  }
  function resetR3(){
    document.getElementById("r3_start").value="";
    document.getElementById("r3_ext").value="00:00";
    document.getElementById("r3_err").textContent="";
    document.getElementById("r3_res").style.display="none";
  }

  // ======= Rechner 4 =======
  function calcR4(){
    const err=document.getElementById("r4_err");
    err.textContent="";
    const now=parseHM(document.getElementById("r4_now").value);
    const start=parseHM(document.getElementById("r4_start").value);
    const pauseTaken=parseHM(document.getElementById("r4_pause").value);

    if(Number.isNaN(now)||Number.isNaN(start)||Number.isNaN(pauseTaken)){
      err.textContent="Bitte Anfrage-Zeit, Dienstbeginn und Pause eingeben.";
      document.getElementById("r4_res").style.display="none";
      return;
    }
    // Spontan: ab Anfrage beginnt Duschzeit sofort -> Dienstende = now + 25
    const end = now + DUSCH;
    const presence = diffClock(end, start);
    // Tageszettel = Anwesenheit - (tats√§chlich genommene Pause)
    const zettel = presence - pauseTaken;

    // Regul√§r: Start + 7:48 + 0:30 (Grundschicht) ‚Äì hier bewusst fix 30,
    // weil Block 4 auf ‚ÄûNormschicht‚Äú zielt; ArbZG-√úberpr√ºfung macht eher Rechner 5/3.
    const regEnd = start + BASE_WORK + P30;

    const entnahme = Math.max(0, regEnd - end);

    document.getElementById("r4_end").textContent = fmtClock(end);
    document.getElementById("r4_shower").textContent = fmtClock(now);
    document.getElementById("r4_zettel").textContent = fmtDur(zettel);
    document.getElementById("r4_entnahme").textContent = fmtDur(entnahme);
    document.getElementById("r4_regend").textContent = fmtClock(regEnd);

    document.getElementById("r4_res").style.display="block";
  }
  function resetR4(){
    document.getElementById("r4_now").value="";
    document.getElementById("r4_start").value="";
    document.getElementById("r4_pause").value="00:30";
    document.getElementById("r4_err").textContent="";
    document.getElementById("r4_res").style.display="none";
  }

  // ======= Rechner 5 =======
  function calcR5(){
    const err=document.getElementById("r5_err");
    err.textContent="";
    const start=parseHM(document.getElementById("r5_start").value);
    const paper=parseHM(document.getElementById("r5_paper").value);

    if(Number.isNaN(start)||Number.isNaN(paper)){
      err.textContent="Bitte Dienstbeginn und Beginn Duschzeit eingeben.";
      document.getElementById("r5_res").style.display="none";
      return;
    }
    const end = paper + DUSCH;
    const presence = diffClock(end, start);        // inkl. Pause & Duschen
    const pause = autoPauseFromPresence(presence); // stabil
    const zettel = presence - pause;

    document.getElementById("r5_end").textContent = fmtClock(end);
    document.getElementById("r5_shower").textContent = fmtClock(paper);
    document.getElementById("r5_pause").textContent = fmtDur(pause);
    document.getElementById("r5_zettel").textContent = fmtDur(zettel);

    const note=document.getElementById("r5_note");
    note.style.display="block";
    note.className="note "+(pause===P45?"warn":"ok");
    note.textContent = (pause===P45)
      ? "‚ö†Ô∏è Arbeitszeit √ºber 9 Stunden ‚Üí 45 Minuten Pause erforderlich."
      : "‚úÖ Bis 9 Stunden Arbeitszeit ‚Üí 30 Minuten Pause ausreichend.";

    document.getElementById("r5_res").style.display="block";
  }
  function resetR5(){
    document.getElementById("r5_start").value="";
    document.getElementById("r5_paper").value="";
    document.getElementById("r5_err").textContent="";
    document.getElementById("r5_res").style.display="none";
  }
</script>
</body>
</html>